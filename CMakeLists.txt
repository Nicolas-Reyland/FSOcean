cmake_minimum_required(VERSION 3.21)
project(Ocean C)

set(CMAKE_C_STANDARD 11)

include(CTest)

include_directories(headers)

add_executable(Ocean main.c sources/misc/impl.c headers/misc/impl.h headers/lexer/token.h sources/lexer/token.c headers/lexer/char_categories.h sources/lexer/char_categories.c headers/eval/string_eval.h sources/eval/string_eval.c headers/combinators/combinator.h sources/combinators/combinator.c sources/misc/stack.c headers/misc/stack.h sources/parser/abstractions/abstraction.c headers/parser/abstractions/abstraction.h sources/parser/cst.c headers/parser/cst.h sources/parser/parse_context.c headers/parser/parse_context.h sources/parser/parser.c headers/parser/parser.h headers/misc/atom_type.h sources/lexer/xbd_operators.c headers/lexer/xbd_operators.h sources/string_utils/string_utils.c headers/string_utils/string_utils.h sources/lexer/parameter_expansion.c headers/lexer/parameter_expansion.h sources/lexer/command_substitution.c headers/lexer/command_substitution.h sources/lexer/arithmetic_expansion.c headers/lexer/arithmetic_expansion.h sources/testing/test.c headers/testing/test.h sources/misc/atom_type.c headers/lexer/candidates.h sources/misc/interactive.c headers/misc/interactive.h sources/lexer/shell_grammar/lexical_conventions.c headers/lexer/shell_grammar/lexical_conventions.h headers/combinators/combinator_types.h headers/lexer/shell_grammar/rules.h sources/lexer/shell_grammar/rules.c sources/misc/output.c headers/misc/output.h sources/eval/expansion/filename_exp.c headers/eval/expansion/filename_exp.h sources/misc/safemem.c headers/misc/safemem.h sources/executable/executable.c headers/executable/executable.h headers/executable/exec_command.h headers/executable/executable_union.h headers/executable/executable_type.h headers/executable/exec_for_loop.h headers/executable/exec_while_loop.h headers/executable/exec_until_loop.h headers/executable/exec_if.h headers/executable/exec_case.h sources/executable/exec_command.c sources/executable/exec_if.c sources/executable/exec_for_loop.c sources/executable/exec_while_loop.c sources/executable/exec_unitl_loop.c sources/executable/exec_case.c headers/executable/executable_flags.h sources/eval/variables.c headers/eval/variables.h sources/executable/exec_multi_executables.c headers/executable/exec_multi_executables.h sources/parser/abstractions/abstract_complete_commands.c headers/parser/abstractions/abstract_complete_commands.h sources/parser/abstractions/abstract_complete_command.c headers/parser/abstractions/abstract_complete_command.h sources/parser/abstractions/abstract_and_or.c headers/parser/abstractions/abstract_and_or.h sources/parser/abstractions/abstract_pipeline.c headers/parser/abstractions/abstract_pipeline.h sources/parser/abstractions/abstract_compound_command.c headers/parser/abstractions/abstract_compound_command.h sources/executable/exec_redirect.c headers/executable/exec_redirect.h sources/parser/abstractions/imperfect_abstract_io_redirect.c headers/parser/abstractions/imperfect_abstract_io_redirect.h sources/executable/print_execs.c headers/executable/print_execs.h)
add_executable(OceanDebug sources/misc/impl.c headers/misc/impl.h main.c headers/lexer/token.h sources/lexer/token.c headers/lexer/char_categories.h sources/lexer/char_categories.c headers/eval/string_eval.h sources/eval/string_eval.c headers/combinators/combinator.h sources/combinators/combinator.c sources/misc/stack.c headers/misc/stack.h sources/parser/abstractions/abstraction.c headers/parser/abstractions/abstraction.h sources/parser/cst.c headers/parser/cst.h sources/parser/parse_context.c headers/parser/parse_context.h sources/parser/parser.c headers/parser/parser.h headers/misc/atom_type.h sources/lexer/xbd_operators.c headers/lexer/xbd_operators.h sources/string_utils/string_utils.c headers/string_utils/string_utils.h sources/lexer/parameter_expansion.c headers/lexer/parameter_expansion.h sources/lexer/command_substitution.c headers/lexer/command_substitution.h sources/lexer/arithmetic_expansion.c headers/lexer/arithmetic_expansion.h sources/testing/test.c headers/testing/test.h sources/misc/atom_type.c headers/lexer/candidates.h sources/misc/interactive.c headers/misc/interactive.h sources/lexer/shell_grammar/lexical_conventions.c headers/lexer/shell_grammar/lexical_conventions.h headers/combinators/combinator_types.h headers/lexer/shell_grammar/rules.h sources/lexer/shell_grammar/rules.c sources/misc/output.c headers/misc/output.h sources/eval/expansion/filename_exp.c headers/eval/expansion/filename_exp.h sources/misc/safemem.c headers/misc/safemem.h sources/executable/executable.c headers/executable/executable.h headers/executable/exec_command.h headers/executable/executable_union.h headers/executable/executable_type.h headers/executable/exec_for_loop.h headers/executable/exec_while_loop.h headers/executable/exec_until_loop.h headers/executable/exec_if.h headers/executable/exec_case.h sources/executable/exec_command.c sources/executable/exec_if.c sources/executable/exec_for_loop.c sources/executable/exec_while_loop.c sources/executable/exec_unitl_loop.c sources/executable/exec_case.c headers/executable/executable_flags.h sources/eval/variables.c headers/eval/variables.h sources/executable/exec_multi_executables.c headers/executable/exec_multi_executables.h sources/parser/abstractions/abstract_complete_commands.c headers/parser/abstractions/abstract_complete_commands.h sources/parser/abstractions/abstract_complete_command.c headers/parser/abstractions/abstract_complete_command.h sources/parser/abstractions/abstract_and_or.c headers/parser/abstractions/abstract_and_or.h sources/parser/abstractions/abstract_pipeline.c headers/parser/abstractions/abstract_pipeline.h sources/parser/abstractions/abstract_compound_command.c headers/parser/abstractions/abstract_compound_command.h sources/executable/exec_redirect.c headers/executable/exec_redirect.h sources/parser/abstractions/imperfect_abstract_io_redirect.c headers/parser/abstractions/imperfect_abstract_io_redirect.h sources/executable/print_execs.c headers/executable/print_execs.h)
add_executable(OceanTokens main.c sources/misc/impl.c headers/misc/impl.h headers/lexer/token.h sources/lexer/token.c headers/lexer/char_categories.h sources/lexer/char_categories.c headers/eval/string_eval.h sources/eval/string_eval.c headers/combinators/combinator.h sources/combinators/combinator.c sources/misc/stack.c headers/misc/stack.h sources/parser/abstractions/abstraction.c headers/parser/abstractions/abstraction.h sources/parser/cst.c headers/parser/cst.h sources/parser/parse_context.c headers/parser/parse_context.h sources/parser/parser.c headers/parser/parser.h headers/misc/atom_type.h sources/lexer/xbd_operators.c headers/lexer/xbd_operators.h sources/string_utils/string_utils.c headers/string_utils/string_utils.h sources/lexer/parameter_expansion.c headers/lexer/parameter_expansion.h sources/lexer/command_substitution.c headers/lexer/command_substitution.h sources/lexer/arithmetic_expansion.c headers/lexer/arithmetic_expansion.h sources/testing/test.c headers/testing/test.h sources/misc/atom_type.c headers/lexer/candidates.h sources/misc/interactive.c headers/misc/interactive.h sources/lexer/shell_grammar/lexical_conventions.c headers/lexer/shell_grammar/lexical_conventions.h headers/combinators/combinator_types.h headers/lexer/shell_grammar/rules.h sources/lexer/shell_grammar/rules.c sources/misc/output.c headers/misc/output.h sources/eval/expansion/filename_exp.c headers/eval/expansion/filename_exp.h sources/misc/safemem.c headers/misc/safemem.h sources/executable/executable.c headers/executable/executable.h headers/executable/exec_command.h headers/executable/executable_union.h headers/executable/executable_type.h headers/executable/exec_for_loop.h headers/executable/exec_while_loop.h headers/executable/exec_until_loop.h headers/executable/exec_if.h headers/executable/exec_case.h sources/executable/exec_command.c sources/executable/exec_if.c sources/executable/exec_for_loop.c sources/executable/exec_while_loop.c sources/executable/exec_unitl_loop.c sources/executable/exec_case.c headers/executable/executable_flags.h sources/eval/variables.c headers/eval/variables.h sources/executable/exec_multi_executables.c headers/executable/exec_multi_executables.h sources/parser/abstractions/abstract_complete_commands.c headers/parser/abstractions/abstract_complete_commands.h sources/parser/abstractions/abstract_complete_command.c headers/parser/abstractions/abstract_complete_command.h sources/parser/abstractions/abstract_and_or.c headers/parser/abstractions/abstract_and_or.h sources/parser/abstractions/abstract_pipeline.c headers/parser/abstractions/abstract_pipeline.h sources/parser/abstractions/abstract_compound_command.c headers/parser/abstractions/abstract_compound_command.h sources/executable/exec_redirect.c headers/executable/exec_redirect.h sources/parser/abstractions/imperfect_abstract_io_redirect.c headers/parser/abstractions/imperfect_abstract_io_redirect.h sources/executable/print_execs.c headers/executable/print_execs.h)
add_executable(OceanMemory main.c sources/misc/impl.c headers/misc/impl.h headers/lexer/token.h sources/lexer/token.c headers/lexer/char_categories.h sources/lexer/char_categories.c headers/eval/string_eval.h sources/eval/string_eval.c headers/combinators/combinator.h sources/combinators/combinator.c sources/misc/stack.c headers/misc/stack.h sources/parser/abstractions/abstraction.c headers/parser/abstractions/abstraction.h sources/parser/cst.c headers/parser/cst.h sources/parser/parse_context.c headers/parser/parse_context.h sources/parser/parser.c headers/parser/parser.h headers/misc/atom_type.h sources/lexer/xbd_operators.c headers/lexer/xbd_operators.h sources/string_utils/string_utils.c headers/string_utils/string_utils.h sources/lexer/parameter_expansion.c headers/lexer/parameter_expansion.h sources/lexer/command_substitution.c headers/lexer/command_substitution.h sources/lexer/arithmetic_expansion.c headers/lexer/arithmetic_expansion.h sources/testing/test.c headers/testing/test.h sources/misc/atom_type.c headers/lexer/candidates.h sources/misc/interactive.c headers/misc/interactive.h sources/lexer/shell_grammar/lexical_conventions.c headers/lexer/shell_grammar/lexical_conventions.h headers/combinators/combinator_types.h headers/lexer/shell_grammar/rules.h sources/lexer/shell_grammar/rules.c sources/misc/output.c headers/misc/output.h sources/eval/expansion/filename_exp.c headers/eval/expansion/filename_exp.h sources/misc/safemem.c headers/misc/safemem.h sources/executable/executable.c headers/executable/executable.h headers/executable/exec_command.h headers/executable/executable_union.h headers/executable/executable_type.h headers/executable/exec_for_loop.h headers/executable/exec_while_loop.h headers/executable/exec_until_loop.h headers/executable/exec_if.h headers/executable/exec_case.h sources/executable/exec_command.c sources/executable/exec_if.c sources/executable/exec_for_loop.c sources/executable/exec_while_loop.c sources/executable/exec_unitl_loop.c sources/executable/exec_case.c headers/executable/executable_flags.h sources/eval/variables.c headers/eval/variables.h sources/executable/exec_multi_executables.c headers/executable/exec_multi_executables.h sources/parser/abstractions/abstract_complete_commands.c headers/parser/abstractions/abstract_complete_commands.h sources/parser/abstractions/abstract_complete_command.c headers/parser/abstractions/abstract_complete_command.h sources/parser/abstractions/abstract_and_or.c headers/parser/abstractions/abstract_and_or.h sources/parser/abstractions/abstract_pipeline.c headers/parser/abstractions/abstract_pipeline.h sources/parser/abstractions/abstract_compound_command.c headers/parser/abstractions/abstract_compound_command.h sources/executable/exec_redirect.c headers/executable/exec_redirect.h sources/parser/abstractions/imperfect_abstract_io_redirect.c headers/parser/abstractions/imperfect_abstract_io_redirect.h sources/executable/print_execs.c headers/executable/print_execs.h)

target_compile_definitions(OceanDebug PUBLIC OCEAN_DEBUG_MACRO)
target_compile_definitions(OceanTokens PUBLIC OCEAN_DEBUG_TOKENS_MACRO)
target_compile_definitions(OceanMemory PUBLIC OCEAN_DEBUG_MEMORY)

# Tokenization tests
add_test(NAME Tokenization_Simple COMMAND Ocean -t tokenization/simple 0x001)
add_test(NAME Tokenization_SimpleTLC COMMAND Ocean -t tokenization/simple-tlc 0x003)
add_test(NAME Tokenization_3Candi COMMAND Ocean -t tokenization/3-candidates 0x001)
# Parsing tests
add_test(NAME Parsing_Simple COMMAND Ocean -t parsing/simple 0x10)
add_test(NAME Parsing_And_Or COMMAND Ocean -t parsing/and_or 0x10)
add_test(NAME Parsing_Redirect COMMAND Ocean -t parsing/redirect 0x10)

# Abstraction tests

# Executions tests
